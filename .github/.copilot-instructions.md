# ğŸ¤– Instructions Copilot - Java Cine API

## ğŸ¯ CONTEXTE DU PROJET

**API Spring Boot** pour gestion de films et sÃ©ries avec intÃ©gration TMDB.

### Stack technique :
- **Backend** : Spring Boot + Java 17 + Gradle + JPA/Hibernate + PostgreSQL
- **APIs externes** : TMDB
- **Base de donnÃ©es** : PostgreSQL avec entitÃ©s Movie/Serie
- **Dev server** : `./gradlew bootRun` sur port 8080
- **Hot reload** : Spring Boot DevTools activÃ©

---

## ğŸ“‹ RÃˆGLES DE REFACTORING

### âœ… **AutorisÃ© sans confirmation :**
- AmÃ©lioration du code existant (clean code, performance)
- Ajout de commentaires et documentation
- Restructuration des packages
- Optimisation des imports
- AmÃ©lioration des annotations Spring
- Mise Ã  jour des DTOs et validations
- AmÃ©lioration de la gestion des exceptions
- Lancer le serveur de dÃ©veloppement pour tester les changements

### âš ï¸ **Interdictions strictes :**
- **NE PAS modifier les fonctionnalitÃ©s existantes**
- **NE PAS changer les endpoints API**
- **NE PAS modifier les entitÃ©s JPA sans accord**
- **NE PAS changer la structure des rÃ©ponses JSON**

---

## ğŸš€ RÃˆGLES D'EXÃ‰CUTION DES COMMANDES

- âœ… Ne pas attendre d'appui sur "Continuer" pour les lignes de commande
- âœ… EnchaÃ®ner les commandes nÃ©cessaires pour accomplir la tÃ¢che
- âœ… Utiliser `./gradlew` (wrapper) au lieu de `gradle`

### **Exceptions nÃ©cessitant confirmation** :
- âš ï¸ Suppression de fichiers importants
- âš ï¸ Modification de configuration systÃ¨me
- âš ï¸ Ajout de nouvelles dÃ©pendances dans build.gradle
- âš ï¸ Changements irrÃ©versibles

---

## ğŸ“ STRUCTURE PROJET JAVA

```
src/main/java/com/example/java_cine_api/
â”œâ”€â”€ JavaCineApiApplication.java    # Main Spring Boot
â”œâ”€â”€ controller/                    # ContrÃ´leurs REST
â”‚   â”œâ”€â”€ HelloController.java      # Endpoint global /api
â”‚   â”œâ”€â”€ MovieController.java      # CRUD films
â”‚   â””â”€â”€ SerieController.java      # CRUD sÃ©ries
â”œâ”€â”€ service/                       # Services mÃ©tier
â”‚   â”œâ”€â”€ MovieService.java
â”‚   â”œâ”€â”€ SerieService.java
â”‚   â””â”€â”€ TMDBService.java          # Service TMDB externe
â”œâ”€â”€ entity/                        # EntitÃ©s JPA
â”‚   â”œâ”€â”€ Movie.java
â”‚   â””â”€â”€ Serie.java
â”œâ”€â”€ dto/                          # DTOs et rÃ©ponses
â”‚   â”œâ”€â”€ TMDBMovieResponse.java
â”‚   â””â”€â”€ TMDBSearchResponse.java
â””â”€â”€ repository/                   # Repositories JPA
    â”œâ”€â”€ MovieRepository.java
    â””â”€â”€ SerieRepository.java

src/main/resources/
â”œâ”€â”€ application.properties        # Configuration Spring
â””â”€â”€ application-dev.properties    # Configuration dÃ©veloppement
```

---

## ğŸ¨ BONNES PRATIQUES JAVA/SPRING

### **Code Quality :**
- Utiliser les annotations Spring appropriÃ©es (@RestController, @Service, @Repository)
- Validation avec @Valid et annotations Jakarta Validation
- Gestion d'erreurs avec @ControllerAdvice
- Commentaires en franÃ§ais pour la logique mÃ©tier
- Respecter les conventions de nommage Java

### **API Design :**
- PrÃ©fixe `/api` pour toutes les routes
- Respecter les conventions REST
- RÃ©ponses JSON cohÃ©rentes avec ResponseEntity<>
- Gestion d'erreurs unifiÃ©e
- Documentation des endpoints

### **Base de donnÃ©es :**
- Utiliser JPA/Hibernate pour toutes les requÃªtes
- Annotations @Entity, @Table, @Column appropriÃ©es
- GÃ©rer les relations avec @OneToMany, @ManyToOne
- Optimiser les requÃªtes (fetch strategies)

---

## ğŸ”‘ ENDPOINTS ACTUELS

### **Global**
- `GET /` - Message de bienvenue
- `GET /search?q=<query>&limit=<number>` - Recherche globale films/sÃ©ries

### **Films (/movie)**
- `GET /movie` - Liste tous les films
- `GET /movie/wishlist` - Films en wishlist
- `GET /movie/rated` - Films notÃ©s
- `GET /movie/search?q=<query>&limit=<number>` - Recherche films
- `GET /movie/tmdb/:tmdbId` - DÃ©tails TMDB d'un film
- `GET /movie/:id` - DÃ©tails d'un film par ID local
- `POST /movie` - CrÃ©er un film
- `POST /movie/tmdb` - CrÃ©er/mettre Ã  jour depuis TMDB
- `PUT /movie/:id` - Modifier un film
- `DELETE /movie/:id` - Supprimer un film

### **SÃ©ries (/serie)**
- `GET /serie` - Liste toutes les sÃ©ries
- `GET /serie/wishlist` - SÃ©ries en wishlist
- `GET /serie/rated` - SÃ©ries notÃ©es
- `GET /serie/search?q=<query>&limit=<number>` - Recherche sÃ©ries
- `GET /serie/tmdb/:tmdbId` - DÃ©tails TMDB d'une sÃ©rie
- `GET /serie/:id` - DÃ©tails d'une sÃ©rie par ID local
- `POST /serie` - CrÃ©er une sÃ©rie
- `POST /serie/tmdb` - CrÃ©er/mettre Ã  jour depuis TMDB
- `PUT /serie/:id` - Modifier une sÃ©rie
- `DELETE /serie/:id` - Supprimer une sÃ©rie


---

## ğŸ› ï¸ COMMANDES GRADLE ESSENTIELLES

```bash
# Lancement serveur dÃ©veloppement
./gradlew bootRun

# Build du projet
./gradlew build

# Build propre
./gradlew clean build

# Tests
./gradlew test

# Voir les tÃ¢ches disponibles
./gradlew tasks
```

---

## ğŸ”§ GESTION DES DÃ‰PENDANCES

### **DÃ©pendances actuelles (build.gradle) :**
```gradle
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    
    // Ã€ ajouter selon besoins :
    // implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    // implementation 'org.postgresql:postgresql'
    // implementation 'org.springframework.boot:spring-boot-starter-validation'
}
```

---

**Objectif :** Code Java propre, maintenable et performant avec Spring Boot tout en prÃ©servant les fonctionnalitÃ©s existantes.
