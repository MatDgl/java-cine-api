# Java Cine API ðŸŽ¬

API Spring Boot pour la gestion de films et sÃ©ries avec intÃ©gration TMDB (The Movie Database).

Cette API est la version Java/Spring Boot de l'API NestJS originale, offrant les mÃªmes fonctionnalitÃ©s avec une architecture Spring Boot bien structurÃ©e.

## ðŸš€ FonctionnalitÃ©s

### Films
- âœ… CRUD complet des films locaux
- âœ… CrÃ©ation de films depuis TMDB ID
- âœ… Gestion wishlist et notes
- âœ… Recherche avec donnÃ©es TMDB enrichies
- âœ… Enrichissement automatique des posters

### SÃ©ries
- âœ… CRUD complet des sÃ©ries locales
- âœ… CrÃ©ation de sÃ©ries depuis TMDB ID
- âœ… Gestion wishlist et notes
- âœ… Recherche avec donnÃ©es TMDB enrichies
- âœ… Enrichissement automatique des posters

### TMDB Integration
- âœ… Recherche films/sÃ©ries
- âœ… DÃ©tails complets avec crÃ©dits
- âœ… Recherche multi (films + sÃ©ries)
- âœ… Gestion asynchrone pour les performances

## ðŸ—ï¸ Architecture

```
src/main/java/com/example/java_cine_api/
â”œâ”€â”€ controller/          # ContrÃ´leurs REST
â”‚   â”œâ”€â”€ AppController.java
â”‚   â”œâ”€â”€ MovieController.java
â”‚   â””â”€â”€ SerieController.java
â”œâ”€â”€ service/             # Logique mÃ©tier
â”‚   â”œâ”€â”€ TmdbService.java
â”‚   â”œâ”€â”€ MovieService.java
â”‚   â””â”€â”€ SerieService.java
â”œâ”€â”€ repository/          # AccÃ¨s aux donnÃ©es JPA
â”‚   â”œâ”€â”€ MovieRepository.java
â”‚   â””â”€â”€ SerieRepository.java
â”œâ”€â”€ entity/              # EntitÃ©s JPA
â”‚   â”œâ”€â”€ Movie.java
â”‚   â””â”€â”€ Serie.java
â”œâ”€â”€ dto/                 # Data Transfer Objects
â”‚   â”œâ”€â”€ movie/
â”‚   â”œâ”€â”€ serie/
â”‚   â””â”€â”€ tmdb/
â”œâ”€â”€ config/              # Configuration Spring
â”‚   â”œâ”€â”€ ApplicationConfig.java
â”‚   â””â”€â”€ JacksonConfig.java
â””â”€â”€ exception/           # Gestion d'erreurs
    â”œâ”€â”€ GlobalExceptionHandler.java
    â”œâ”€â”€ ResourceNotFoundException.java
    â””â”€â”€ TmdbApiException.java
```

## ðŸ—„ï¸ Base de donnÃ©es

```sql
-- Table Movie
CREATE TABLE movie (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    title VARCHAR(255) NOT NULL,
    tmdb_id INTEGER UNIQUE,
    rating NUMERIC(3,1) CHECK (rating >= 0 AND rating <= 10),
    wishlist BOOLEAN DEFAULT FALSE,
    review VARCHAR(1000),
    view_count INTEGER DEFAULT 0,
    watched BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Table Serie
CREATE TABLE serie (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    title VARCHAR(255) NOT NULL,
    tmdb_id INTEGER UNIQUE,
    rating NUMERIC(3,1) CHECK (rating >= 0 AND rating <= 10),
    wishlist BOOLEAN DEFAULT FALSE,
    review VARCHAR(1000),
    view_count INTEGER DEFAULT 0,
    watched BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## ðŸš€ DÃ©marrage rapide

### PrÃ©requis
- Java 17+
- PostgreSQL
- Token TMDB Bearer

### Configuration

1. **Base de donnÃ©es PostgreSQL** :
```bash
# CrÃ©er la base de donnÃ©es
createdb cine
```

2. **Configuration application.properties** :
```properties
# Base de donnÃ©es
spring.datasource.url=jdbc:postgresql://localhost:5432/cine
spring.datasource.username=postgres
spring.datasource.password=your_password

# TMDB API
tmdb.bearer.token=your_tmdb_token
```

3. **DÃ©marrage** :
```bash
./gradlew bootRun
```

L'API sera disponible sur : http://localhost:8080

## ðŸ“š API Endpoints

### Films (`/movie`)

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/movie` | Tous les films avec posters |
| GET | `/movie/wishlist` | Films en wishlist |
| GET | `/movie/rated` | Films notÃ©s |
| GET | `/movie/search?q=query&limit=20` | Recherche TMDB + statut local |
| GET | `/movie/tmdb/{tmdbId}` | DÃ©tails TMDB + statut local |
| GET | `/movie/{id}` | Film local par ID |
| POST | `/movie` | CrÃ©er film manuel |
| POST | `/movie/tmdb` | CrÃ©er film depuis TMDB |
| PUT | `/movie/{id}` | Modifier film |
| DELETE | `/movie/{id}` | Supprimer film |

### SÃ©ries (`/serie`)

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/serie` | Toutes les sÃ©ries avec posters |
| GET | `/serie/wishlist` | SÃ©ries en wishlist |
| GET | `/serie/rated` | SÃ©ries notÃ©es |
| GET | `/serie/search?q=query&limit=20` | Recherche TMDB + statut local |
| GET | `/serie/tmdb/{tmdbId}` | DÃ©tails TMDB + statut local |
| GET | `/serie/{id}` | SÃ©rie locale par ID |
| POST | `/serie` | CrÃ©er sÃ©rie manuelle |
| POST | `/serie/tmdb` | CrÃ©er sÃ©rie depuis TMDB |
| PUT | `/serie/{id}` | Modifier sÃ©rie |
| DELETE | `/serie/{id}` | Supprimer sÃ©rie |

### GÃ©nÃ©ral

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/` | Info API |
| GET | `/health` | SantÃ© API |
| GET | `/search?q=query` | Recherche multi TMDB |

## ðŸŽ¯ Exemples d'utilisation

### CrÃ©er un film depuis TMDB
```bash
curl -X POST http://localhost:8080/movie/tmdb \
  -H "Content-Type: application/json" \
  -d '{
    "tmdbId": 550,
    "rating": 9.5,
    "wishlist": true,
    "review": "Chef-d'\''oeuvre absolu!"
  }'
```

### Rechercher des films
```bash
curl "http://localhost:8080/movie/search?q=fight+club&limit=10"
```

### RÃ©cupÃ©rer tous les films
```bash
curl http://localhost:8080/movie
```

## ðŸ”§ Configuration avancÃ©e

### Profils Spring
- `default` : Production
- `dev` : DÃ©veloppement avec logs dÃ©taillÃ©s

```bash
./gradlew bootRun --args='--spring.profiles.active=dev'
```

### Variables d'environnement
```bash
export DATABASE_URL=jdbc:postgresql://localhost:5432/cine
export TMDB_BEARER_TOKEN=your_token
export SPRING_PROFILES_ACTIVE=dev
```

## ðŸ§ª Tests

```bash
# Tests unitaires
./gradlew test

# Tests avec couverture
./gradlew test jacocoTestReport
```

## ðŸ—ï¸ Build et dÃ©ploiement

```bash
# Build JAR
./gradlew build

# ExÃ©cuter le JAR
java -jar build/libs/java-cine-api-0.0.1-SNAPSHOT.jar
```

## ðŸ“¦ Migration depuis NestJS

Cette API Java reproduit fidÃ¨lement l'API NestJS originale :

- âœ… MÃªmes endpoints et structure de rÃ©ponse
- âœ… MÃªme logique mÃ©tier et validation
- âœ… Compatible avec le frontend Next.js existant
- âœ… Architecture Spring Boot optimisÃ©e
- âœ… Gestion d'erreurs robuste
- âœ… Performances amÃ©liorÃ©es avec requÃªtes asynchrones

## ðŸ¤ Contribution

1. Fork le projet
2. CrÃ©er une branche feature (`git checkout -b feature/AmazingFeature`)
3. Commit (`git commit -m 'Add some AmazingFeature'`)
4. Push (`git push origin feature/AmazingFeature`)
5. CrÃ©er une Pull Request

## ðŸ“„ Licence

DistribuÃ© sous licence MIT. Voir `LICENSE` pour plus d'informations.
